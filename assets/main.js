(function(){
  const yr=document.getElementById('year'); if(yr){ yr.textContent=new Date().getFullYear(); }
  function initServices(){ document.querySelectorAll('.svc-wrap').forEach(wrap=>{ const tile=wrap.querySelector('.svc-tile'); const details=wrap.querySelector('.svc-details'); tile&&details&&tile.addEventListener('click',()=>details.classList.toggle('open')); }); }
  function initGallery(){ const stage=document.getElementById('galleryStage'); const wrap=document.getElementById('gallery'); const prevBtn=document.getElementById('galleryPrev'); const nextBtn=document.getElementById('galleryNext'); if(!stage||!wrap) return; const folder=wrap.getAttribute('data-folder')||'images/gallery'; const count=parseInt(wrap.getAttribute('data-count')||'10',10); const base=wrap.getAttribute('data-base')||'image'; const ext=wrap.getAttribute('data-ext')||'jpg'; let i=1,active,incoming,timer; function makeImg(){ const img=document.createElement('img'); img.className='gallery__img'; img.alt=''; return img;} function src(n){return folder+'/'+base+n+'.'+ext;} function show(n,dir){ incoming=makeImg(); incoming.src=src(n); incoming.alt='Gallery image '+n; incoming.classList.add(dir==='next'?'enter-right':'enter-left'); stage.appendChild(incoming); requestAnimationFrame(()=>{ if(active){ active.classList.add(dir==='next'?'exit-left':'exit-right'); active.classList.remove('active'); } incoming.classList.remove(dir==='next'?'enter-right':'enter-left'); incoming.classList.add('active'); setTimeout(()=>{ if(active){ stage.removeChild(active);} active=incoming; },480); }); } function startTimer(){ clearInterval(timer); timer=setInterval(()=>{ i=(i%count)+1; show(i,'next'); },5000); } function goPrev(){ i=(i-2+count)%count+1; show(i,'prev'); startTimer(); } function goNext(){ i=(i%count)+1; show(i,'next'); startTimer(); } prevBtn?.addEventListener('click',goPrev); nextBtn?.addEventListener('click',goNext); active=makeImg(); active.src=src(i); active.classList.add('active'); stage.appendChild(active); startTimer(); }
  function applyLang(lang){ const dict=window.I18N_DICT; document.querySelectorAll('[data-i18n]').forEach(el=>{ const k=el.getAttribute('data-i18n'); if(dict[lang]&&dict[lang][k]) el.textContent=dict[lang][k]; }); document.documentElement.lang=(lang==='ta'?'ta':'en'); try{document.getElementById('lang-en').setAttribute('aria-pressed',lang==='en');document.getElementById('lang-ta').setAttribute('aria-pressed',lang==='ta');}catch(e){} }
  window.I18N_APPLY=applyLang;
  window.addEventListener('load',()=>{ initServices(); initGallery(); });
})();